{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Xmas 2025</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kedebideri:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body>
    <h1 class="h1_header text_black">
        Add item{% if person_name %} for {{ person_name }}{% endif %}
    </h1>
    
    {% if person_name %}
        <a href="{% url 'main_list:items' person_name=person_name %}">‚Üê Back to {{ person_name }}'s List</a>
    {% endif %}

    <form method="post" class="add-item-form">
        {% csrf_token %}
        
        <!-- Item name -->
        <label>Item name</label>
        <input type="text" name="name" id="item-name" placeholder="Enter item name" required>
        
        <!-- Tagged people - now with add new functionality -->
        <label>For whom</label>
        <select name="tagged_people" id="tagged-people" multiple>
            {% for person in people %}
                <option value="{{ person.id }}">{{ person.who }}</option>
            {% endfor %}
        </select>
              
        <!-- Gift type -->
        <label class="form_add_label">Gift type</label>
        <select name="type_gift" id="gift-type" required>
            <option value="">Select type...</option>
            <option value="stocking">Stocking</option>
            <option value="main">Main</option>
        </select>
        
        <!-- Price -->
        <label class="form_add_label">Price</label>
        <input type="number" step="0.01" name="price" id="price" placeholder="Enter price" required>
        
        <!-- Submit button -->
        <button class="mdc-button mdc-button--raised" type="submit">
            <span class="mdc-button__label">Add Item</span>
        </button>
    </form>

    <div class="home-bar">
        <a href="{% url 'main_list:index' %}">
            <div class="home-bar-emoji">üè†</div>
            <div class="home-bar-text">Home</div>
        </a>
        <a href="{% url 'main_list:add_item_general' %}">
            <div class="home-bar-emoji">‚ûï</div>
            <div class="home-bar-text">Add</div>
        </a>
        <a href="{% url 'main_list:calculator' %}">
            <div class="home-bar-emoji">üßÆ</div>
            <div class="home-bar-text">Calculator</div>
        </a>
    </div>

    <script>
        $(document).ready(function() {
            // Initialize Select2 for people with tags (create new)
            $('#tagged-people').select2({
                tags: true,
                placeholder: 'Type to search or add new...',
                tokenSeparators: [','],
                createTag: function (params) {
                    var term = $.trim(params.term);
                    if (term === '') {
                        return null;
                    }
                    return {
                        id: term,
                        text: term,
                        newTag: true
                    }
                }
            });

            // Initialize Select2 for gift type (no tags)
            $('#gift-type').select2({
                placeholder: 'Select type...',
                minimumResultsForSearch: Infinity // Disable search
            });
        });
    </script>
</body>
</html>